var StackedColumnDrillView=function(t){function e(t,i,n,o,r){this.view=t,this.seriesData=i,this.categoryArray=n,this.requiredcategoryArr=o,this.title=r,this.destroy=__bind(this.destroy,this),this.resize=__bind(this.resize,this),e.__super__.constructor.call(this,this.view),this.parent=$("#"+this.id).parent(),this.chart1Click()}return __bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(t,e){function i(){this.constructor=t}for(var n in e)__hasProp.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},__extends(e,t),e.prototype.setChart=function(t){this.chart&&this.destroy(),this.chart=new Highcharts.Chart(t),this.chart=$("#"+this.id).highcharts(),this.resize({width:this.parent.width(),height:this.parent.height()})},e.prototype.getInfo=function(){},e.prototype.resize=function(t){if(this.chart)if(this.chart.containerWidth<t.width){this.chart.options.title.style.fontSize="2em",this.chart.options.subtitle.style.fontSize="1.3em",this.chart.options.xAxis[0].title.style.fontSize="1.3em",this.chart.options.yAxis[0].stackLabels.style.fontSize="1.3em",this.chart.options.legend.itemStyle.fontSize="1.3em",this.chart.options.xAxis[0].labels.style.fontSize="1.3em",this.chart.options.tooltip.style.fontSize="1.3em",this.chart=new Highcharts.Chart(this.chart.options);var e=.33*this.chart.containerWidth+this.chart.containerWidth;$("#"+this.id+"-action-bar-div").width(e+100),$("#"+this.id+"-vroot").css({position:"absolute",top:"0px",left:e/2}),this.chart.setSize(e+100,e+100,!1),this.chart.redraw()}else this.chart.options.title.style.fontSize="1em",this.chart.options.subtitle.style.fontSize="0.8em",this.chart.options.xAxis[0].title.style.fontSize="0.8em",this.chart.options.yAxis[0].stackLabels.style.fontSize="0.8em",this.chart.options.legend.itemStyle.fontSize="0.8em",this.chart.options.xAxis[0].labels.style.fontSize="0.8em",this.chart.options.tooltip.style.fontSize="0.8em",this.chart=new Highcharts.Chart(this.chart.options),$("#"+this.id+"-action-bar-div").width(t.width),$("#"+this.id+"-vroot").css({position:"absolute",top:"0px",left:"475px"}),this.chart.setSize(t.width,t.height,!1),this.chart.redraw()},e.prototype.destroy=function(){this.chart.destroy()},e.prototype.chart1=function(t){return Highcharts.setOptions({lang:{myButtonTitle:"Back"}}),{chart:{style:{fontSize:"1em"},renderTo:this.id,borderWidth:.5,type:"column"},credits:{style:{fontSize:"0.7em"},enabled:!1},legend:{itemStyle:{fontSize:"0.8em"}},title:{style:{fontSize:"1em"},text:"New PR/New Citizen"},subtitle:{style:{fontSize:"0.8em"},text:this.title},xAxis:{title:{margin:20,text:"Month and Year",style:{fontSize:"0.8em"}},labels:{style:{fontSize:"0.8em"}},categories:this.categoryArray},yAxis:{title:{enabled:!0,style:{fontSize:"1em"},text:"count"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:"gray",fontSize:"0.8em"},formatter:function(){return this.stack}},allowDecimals:!1,min:0,title:{text:""}},tooltip:{style:{fontSize:"0.8em"},formatter:function(){return"<b>"+this.point.options.year+": </b><br/>"+this.series.name+": "+this.y+"<br/>Total: "+this.point.stackTotal}},plotOptions:{column:{stacking:"normal",events:{click:_.bind(this.chart2Click,this),legendItemClick:function(){var t=this.name,e=this.chart.series;return $.each(e,function(e,i){i.name==t&&(i.visible?i.hide():i.show())}),!1}}},series:{cursor:"pointer",point:{events:{}}}},series:t,navigation:{buttonOptions:{theme:{style:{color:"#039",textDecoration:"underline"}}}},exporting:{buttons:{printButton:{enabled:!1},exportButton:{enabled:!1},customButton:{x:-28,text:"Back",_id:"myButton",onclick:_.bind(this.chartBackClick,this),_titleKey:"myButtonTitle"}}}}},e.prototype.chart2=function(t){return Highcharts.setOptions({lang:{myButtonTitle:"Back"}}),{chart:{style:{fontSize:"1em"},renderTo:this.id,borderWidth:.5,type:"column"},credits:{enabled:!1},legend:{itemStyle:{fontSize:"0.8em"}},title:{style:{fontSize:"1em"},text:"New PR/New Citizen"},subtitle:{style:{fontSize:"0.8em"},text:this.title},xAxis:{labels:{style:{fontSize:"0.8em"}},style:{fontSize:"0.8em"},categories:this.categoryArray,title:{margin:20,enabled:!0,style:{fontSize:"0.8em"},text:"Month and Year"}},yAxis:{title:{enabled:!0,style:{fontSize:"1em"},text:"count"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:"gray",fontSize:"0.8em"},formatter:function(){return this.stack}},allowDecimals:!1,min:0,title:{text:""}},tooltip:{style:{fontSize:"0.8em"},formatter:function(){return"<b>"+this.point.options.year+": </b><br/>"+this.series.name+": "+this.y+"<br/>Total: "+this.point.stackTotal}},plotOptions:{column:{stacking:"normal",events:{click:_.bind(this.chart3Click,this),legendItemClick:function(){var t=this.name,e=this.chart.series;return $.each(e,function(e,i){i.name==t&&(i.visible?i.hide():i.show())}),!1}}},series:{cursor:"pointer",point:{events:{}}}},series:t,navigation:{buttonOptions:{theme:{style:{color:"#039",textDecoration:"underline"}}}},exporting:{buttons:{printButton:{enabled:!1},exportButton:{enabled:!1},customButton:{x:-28,text:"Back",_id:"myButton",onclick:_.bind(this.chartBackClick,this),_titleKey:"myButtonTitle"}}}}},e.prototype.chart3=function(t){return Highcharts.setOptions({lang:{myButtonTitle:"Back"}}),{chart:{renderTo:this.id,borderWidth:.5,style:{fontSize:"1em"},type:"column"},credits:{style:{fontSize:"0.7em"},enabled:!1},legend:{itemStyle:{fontSize:"0.8em"}},title:{style:{fontSize:"1em"},text:"New PR/New Citizen"},subtitle:{style:{fontSize:"0.8em"},text:this.title},xAxis:{labels:{style:{fontSize:"0.8em"}},style:{fontSize:"0.8em"},categories:this.categoryArray,title:{margin:20,enabled:!0,style:{fontSize:"0.8em"},text:"Month and Year"}},yAxis:{title:{enabled:!0,style:{fontSize:"1em"},text:"count"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:"gray",fontSize:"0.8em"},formatter:function(){return this.stack}},allowDecimals:!1,min:0,title:{text:""}},tooltip:{style:{fontSize:"0.8em"},formatter:function(){return"<b>"+this.point.options.year+": </b><br/>"+this.series.name+": "+this.y+"<br/>Total: "+this.point.stackTotal}},plotOptions:{column:{stacking:"normal",events:{legendItemClick:function(){var t=this.name,e=this.chart.series;return $.each(e,function(e,i){i.name==t&&(i.visible?i.hide():i.show())}),!1}}},series:{cursor:"pointer",point:{events:{}}}},series:t,navigation:{buttonOptions:{theme:{style:{color:"#039",textDecoration:"underline"}}}},exporting:{buttons:{printButton:{enabled:!1},exportButton:{enabled:!1},customButton:{x:-28,text:"Back",_id:"myButton",onclick:_.bind(this.chartBackClick,this),_titleKey:"myButtonTitle"}}}}},e.prototype.chart1Click=function(){var t=this.chart1(this.seriesData);this.setChart(t)},e.prototype.chartBackClick=function(){var t=this.chart1(this.seriesData);this.setChart(t)},e.prototype.chart2Click=function(t){var e=t.currentTarget,i=this.getchart2Data(e.points[0].scenario),n=this.chart2(i);this.setChart(n)},e.prototype.chart3Click=function(t){var e=t.currentTarget,i=this.getchart3Data(e.points[0].scenario),n=this.chart3(i);this.setChart(n)},e.prototype.getchart2Data=function(t){var e=this.categoryArray,i=_.where(_.flatten(this.requiredcategoryArr),{cdd_code:t}),n=[],o=[],r=[],s=!1,a=!1;return o=d3.nest().key(function(t){return t.cs_code}).key(function(t){return t.category}).rollup(function(t){return d3.sum(t,function(t){return t.PR})}).entries(i),r=d3.nest().key(function(t){return t.cs_code}).key(function(t){return t.category}).rollup(function(t){return d3.sum(t,function(t){return t.NewCitizen})}).entries(i),o.forEach(function(t){for(var i=[],o=0;o<e.length;o++)t.values.forEach(function(r){r.key==e[o]&&(0==s?(i=[],i.push({x:e.indexOf(e[o]),y:parseInt(r.values),year:e[o],scenario:String(t.key)}),n.push({id:"PR-"+t.key,name:"PR",stack:t.key,color:"#003366",data:i}),s=!0):(i=[],i.push({x:e.indexOf(e[o]),y:parseInt(r.values),year:e[o],scenario:String(t.key)}),n.push({id:"PR-"+t.key,name:"PR",stack:t.key,color:"#003366",data:i,showInLegend:!1})))})}),r.forEach(function(t){for(var i=[],o=0;o<e.length;o++)t.values.forEach(function(r){r.key==e[o]&&(0==a?(i=[],i.push({x:e.indexOf(e[o]),y:parseInt(r.values),year:e[o],scenario:String(t.key)}),n.push({id:"New Citizen-"+t.key,name:"New Citizen",stack:t.key,color:"#00fff9",data:i}),a=!0):(i=[],i.push({x:e.indexOf(e[o]),y:parseInt(r.values),year:e[o],scenario:String(t.key)}),n.push({id:"New Citizen-"+t.key,name:"New Citizen",stack:t.key,color:"#00fff9",data:i,showInLegend:!1})))})}),n},e.prototype.getchart3Data=function(t){var e=this.categoryArray,i=_.where(_.flatten(this.requiredcategoryArr),{cs_code:t}),n=[],o=[],r=[],s=!1,a=!1;return o=d3.nest().key(function(t){return t.div_code}).key(function(t){return t.category}).rollup(function(t){return d3.sum(t,function(t){return t.PR})}).entries(i),o.forEach(function(t){for(var i=[],o=0;o<e.length;o++)t.values.forEach(function(r){r.key==e[o]&&(0==s?(i.push({x:e.indexOf(e[o]),y:parseInt(r.values),year:e[o],scenario:String(t.key)}),n.push({id:"PR-"+t.key,name:"PR",stack:t.key,color:"#003366",data:i}),s=!0):(i=[],i.push({x:e.indexOf(e[o]),y:parseInt(r.values),year:e[o],scenario:String(t.key)}),n.push({id:"PR-"+t.key,name:"PR",stack:t.key,color:"#003366",data:i,showInLegend:!1})))})}),r=d3.nest().key(function(t){return t.div_code}).key(function(t){return t.category}).rollup(function(t){return d3.sum(t,function(t){return t.NewCitizen})}).entries(i),r.forEach(function(t){for(var i=[],o=0;o<e.length;o++)t.values.forEach(function(r){r.key==e[o]&&(0==a?(i=[],i.push({x:e.indexOf(e[o]),y:parseInt(r.values),year:e[o],scenario:String(t.key)}),n.push({id:"New Citizen-"+t.key,name:"New Citizen",stack:t.key,color:"#00fff9",data:i}),a=!0):(i=[],i.push({x:e.indexOf(e[o]),y:parseInt(r.values),year:e[o],scenario:String(t.key)}),n.push({id:"New Citizen-"+t.key,name:"New Citizen",stack:t.key,color:"#00fff9",data:i,showInLegend:!1})))})}),n},e}(BaseView);elx.StackedColumnDrillView=StackedColumnDrillView;